<view class="container">
  <view class="search-bar">
    <view class="search-input-wrapper">
      <text class="search-icon">ğŸ”</text>
      <input 
        class="search-input" 
        placeholder="æœç´¢å•†å“åç§°æˆ–ç¼–ç " 
        value="{{searchKeyword}}"
        bindinput="onSearchInput"
        confirm-type="search"
        bindconfirm="onSearch"
      />
      <text wx:if="{{searchKeyword}}" class="clear-icon" bindtap="clearSearch">âœ•</text>
    </view>
  </view>

  <view wx:if="{{loading}}" class="loading">
    <text>åŠ è½½ä¸­...</text>
  </view>

  <view wx:else>
    <view wx:if="{{filteredProducts.length === 0}}" class="empty-state">
      <text class="empty-icon">ğŸ“¦</text>
      <text>{{searchKeyword ? 'æœªæ‰¾åˆ°åŒ¹é…å•†å“' : 'æš‚æ— å•†å“'}}</text>
    </view>

    <view wx:else class="product-list">
      <view
        class="product-card"
        wx:for="{{filteredProducts}}"
        wx:key="id"
      >
        <view class="product-header" bindtap="viewDetail" data-id="{{item.id}}">
          <view class="product-info">
            <text class="product-name">{{item.name}}</text>
            <text class="product-code">ç¼–ç : {{item.code}}</text>
          </view>
          <view class="qrcode-wrapper">
            <!-- ä½¿ç”¨å¾®ä¿¡å°ç¨‹åºå†…ç½®çš„äºŒç»´ç ç”Ÿæˆèƒ½åŠ› -->
            <image 
              class="qrcode" 
              src="https://api.qrserver.com/v1/create-qr-code/?size=80x80&data={{item.code}}"
              mode="aspectFit"
            ></image>
          </view>
        </view>
        <view class="product-body">
          <view class="product-row">
            <text class="label">ç±»åˆ«:</text>
            <text class="value">{{item.category ? item.category.name : 'æœªåˆ†ç±»'}}</text>
          </view>
          <view class="product-row">
            <text class="label">ä»·æ ¼:</text>
            <text class="value price">Â¥{{item.price}}</text>
          </view>
          <view class="product-row">
            <text class="label">åº“å­˜(æ–¤):</text>
            <text class="value stock {{item.stock < 10 ? 'warning' : ''}}">{{item.stock}}</text>
          </view>
        </view>
        <view class="product-actions">
          <button class="action-btn units" bindtap="navigateToUnits" data-id="{{item.id}}">ç®¡ç†å•ä½</button>
          <button class="action-btn edit" bindtap="navigateToEdit" data-id="{{item.id}}">ç¼–è¾‘</button>
          <button class="action-btn delete" bindtap="deleteProduct" data-id="{{item.id}}">åˆ é™¤</button>
        </view>
      </view>
    </view>
  </view>

  <view class="fab" bindtap="navigateToAdd">+</view>
</view>
